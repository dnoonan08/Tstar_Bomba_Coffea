from coffea.lookup_tools import dense_lookup
import numpy as np

dataDistributions = {2016: {'Nominal': np.array([6.54008056e-06, 2.29382990e-05, 6.32223011e-05, 8.55795569e-05,
                                              1.22592187e-04, 1.64213685e-04, 1.91737805e-04, 3.53071557e-04,
                                              9.65734646e-04, 2.15543869e-03, 4.84612305e-03, 9.86199166e-03,
                                              1.65083341e-02, 2.40057720e-02, 3.21660476e-02, 4.07817602e-02,
                                              4.81844375e-02, 5.32394858e-02, 5.61219355e-02, 5.75573029e-02,
                                              5.84119488e-02, 5.88586927e-02, 5.83078387e-02, 5.64910286e-02,
                                              5.37586976e-02, 5.04444757e-02, 4.66722004e-02, 4.25746595e-02,
                                              3.83286721e-02, 3.40573890e-02, 2.98202151e-02, 2.56705381e-02,
                                              2.16921945e-02, 1.79859288e-02, 1.46377690e-02, 1.16979819e-02,
                                              9.17774146e-03, 7.05846121e-03, 5.30638737e-03, 3.88440939e-03,
                                              2.75715011e-03, 1.89012486e-03, 1.24723401e-03, 7.90063501e-04,
                                              4.79456179e-04, 2.78330423e-04, 1.54405355e-04, 8.18145177e-05,
                                              4.14101300e-05, 2.00434976e-05, 9.30691237e-06, 4.17785293e-06,
                                              1.84605702e-06, 8.35039809e-07, 4.14979982e-07, 2.45828763e-07,
                                              1.77914162e-07, 1.48846331e-07, 1.33924257e-07, 1.23839007e-07,
                                              1.15259787e-07, 1.07079064e-07, 9.89863337e-08, 9.09466500e-08,
                                              8.30144693e-08, 7.52676378e-08, 6.77836948e-08, 6.06311650e-08,
                                              5.38663703e-08, 4.75324692e-08, 4.16595442e-08, 3.62652795e-08,
                                              3.13560154e-08, 2.69280514e-08, 2.29691010e-08, 1.94598175e-08,
                                              1.63753198e-08, 1.36866615e-08, 1.13621973e-08, 9.36881001e-09,
                                              7.67297905e-09, 6.24167500e-09, 5.04308009e-09, 4.04713889e-09,
                                              3.22595114e-09, 2.55402268e-09, 2.00839355e-09, 1.56866344e-09,
                                              1.21693497e-09, 9.37694446e-10, 7.17647870e-10, 5.45528239e-10,
                                              4.11887430e-10, 3.08883691e-10, 2.30073302e-10, 1.70212693e-10,
                                              1.25075369e-10, 9.12862643e-11, 6.61747840e-11, 4.76466914e-11,
                                              3.40742065e-11, 2.42031122e-11, 1.70753184e-11, 1.19651523e-11,
                                              8.32758658e-12, 5.75666941e-12, 3.95252234e-12, 2.69542964e-12,
                                              1.82571089e-12, 1.22824805e-12, 8.20710454e-13, 5.44682467e-13,
                                              3.59042722e-13, 2.35070386e-13, 1.52861650e-13, 9.87296890e-14,
                                              6.33352351e-14, 4.03544270e-14, 2.55378872e-14, 1.60519035e-14,
                                              1.00211069e-14, 6.21372897e-15, 3.82680337e-15, 2.34081492e-15,
                                              1.42214845e-15, 8.58162770e-16, 5.14328930e-16, 3.06167060e-16,
                                              1.81018469e-16, 1.06299966e-16, 6.19996851e-17, 3.59162538e-17,
                                              2.06654831e-17, 1.18095794e-17, 6.70306949e-18, 3.77878498e-18,
                                              2.11589309e-18, 1.17672454e-18, 6.49841002e-19, 3.56738442e-19,
                                              1.94143370e-19, 1.05160992e-19, 5.66251495e-20, 3.02000797e-20,
                                              1.59089706e-20, 8.35895064e-21, 4.58394068e-21, 2.15714855e-21,
                                              1.07857428e-21, 8.08930707e-22, 2.69643569e-22, 0.00000000e+00,
                                              2.69643569e-22, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]),
                            'Up': np.array([6.37264207e-06, 1.80615556e-05, 5.98112174e-05, 7.52019431e-05,
                                         1.11510782e-04, 1.47891617e-04, 1.74897169e-04, 2.47635076e-04,
                                         6.51364056e-04, 1.47901519e-03, 3.17738413e-03, 6.73879110e-03,
                                         1.21432636e-02, 1.86266411e-02, 2.56860812e-02, 3.33807102e-02,
                                         4.11281318e-02, 4.73936352e-02, 5.15615009e-02, 5.39179132e-02,
                                         5.51223640e-02, 5.58811400e-02, 5.62745562e-02, 5.57862921e-02,
                                         5.41813945e-02, 5.17471264e-02, 4.87841437e-02, 4.54070787e-02,
                                         4.17150612e-02, 3.78562479e-02, 3.39514821e-02, 3.00624730e-02,
                                         2.62291375e-02, 2.25105593e-02, 1.89880236e-02, 1.57428447e-02,
                                         1.28346635e-02, 1.02912891e-02, 8.11139173e-03, 6.27372859e-03,
                                         4.74838593e-03, 3.50452893e-03, 2.51292016e-03, 1.74470347e-03,
                                         1.16950751e-03, 7.55121006e-04, 4.68809112e-04, 2.79493151e-04,
                                         1.59863860e-04, 8.76832484e-05, 4.61173145e-05, 2.32763557e-05,
                                         1.12984411e-05, 5.30206538e-06, 2.43424232e-06, 1.12207615e-06,
                                         5.45960380e-07, 3.01607288e-07, 1.99891335e-07, 1.56736902e-07,
                                         1.36539803e-07, 1.24901043e-07, 1.16253665e-07, 1.08551652e-07,
                                         1.01100955e-07, 9.37101743e-08, 8.63683912e-08, 7.91252087e-08,
                                         7.20462167e-08, 6.51962328e-08, 5.86328533e-08, 5.24039811e-08,
                                         4.65470212e-08, 4.10888825e-08, 3.60464377e-08, 3.14272796e-08,
                                         2.72306775e-08, 2.34486610e-08, 2.00671745e-08, 1.70672490e-08,
                                         1.44261479e-08, 1.21184519e-08, 1.01170543e-08, 8.39404661e-09,
                                         6.92148293e-09, 5.67201619e-09, 4.61940781e-09, 3.73891532e-09,
                                         3.00756724e-09, 2.40433689e-09, 1.91022881e-09, 1.50829179e-09,
                                         1.18357296e-09, 9.23026473e-10, 7.15389375e-10, 5.51035725e-10,
                                         4.21818569e-10, 3.20907609e-10, 2.42628845e-10, 1.82310906e-10,
                                         1.36141451e-10, 1.01035806e-10, 7.45190249e-11, 5.46217530e-11,
                                         3.97896788e-11, 2.88058882e-11, 2.07251586e-11, 1.48190352e-11,
                                         1.05304565e-11, 7.43668510e-12, 5.21934799e-12, 3.64047057e-12,
                                         2.52349793e-12, 1.73841033e-12, 1.19015989e-12, 8.09770164e-13,
                                         5.47547061e-13, 3.67946043e-13, 2.45725153e-13, 1.63086375e-13,
                                         1.07569249e-13, 7.05116364e-14, 4.59341272e-14, 2.97380156e-14,
                                         1.91333126e-14, 1.22340388e-14, 7.77411370e-15, 4.90945304e-15,
                                         3.08117500e-15, 1.92176644e-15, 1.19120197e-15, 7.33788864e-16,
                                         4.49218097e-16, 2.73302363e-16, 1.65245938e-16, 9.92927390e-17,
                                         5.92930030e-17, 3.51876768e-17, 2.07528477e-17, 1.21636214e-17,
                                         7.08515442e-18, 4.10154833e-18, 2.35938123e-18, 1.34902678e-18,
                                         7.66596667e-19, 4.32777929e-19, 2.42948856e-19, 1.35361072e-19,
                                         7.49609122e-20, 4.15251097e-20, 2.23804162e-20, 1.24036042e-20,
                                         6.74108923e-21, 3.50536640e-21, 1.88750498e-21, 1.07857428e-21,
                                         5.39287138e-22, 2.69643569e-22, 0.00000000e+00, 2.69643569e-22,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]),
                            'Down': np.array([6.77591466e-06, 2.92827700e-05, 6.65036133e-05, 9.76874072e-05,
                                           1.36709310e-04, 1.80565216e-04, 2.21752390e-04, 5.46666352e-04,
                                           1.42165810e-03, 3.28004927e-03, 7.46965720e-03, 1.40530002e-02,
                                           2.19721090e-02, 3.06379203e-02, 4.00652431e-02, 4.87534444e-02,
                                           5.49153640e-02, 5.84730061e-02, 6.02100627e-02, 6.11817875e-02,
                                           6.16913111e-02, 6.10660628e-02, 5.89985788e-02, 5.59171449e-02,
                                           5.21907237e-02, 4.79590048e-02, 4.33995086e-02, 3.87165586e-02,
                                           3.40313686e-02, 2.94059036e-02, 2.49181013e-02, 2.06820881e-02,
                                           1.68144846e-02, 1.33973607e-02, 1.04628283e-02, 7.99981899e-03,
                                           5.97173876e-03, 4.33402025e-03, 3.04341908e-03, 2.05828088e-03,
                                           1.33534248e-03, 8.28424896e-04, 4.90297415e-04, 2.76357660e-04,
                                           1.48185154e-04, 7.55498514e-05, 3.66331287e-05, 1.69218827e-05,
                                           7.48151319e-06, 3.20317457e-06, 1.36571649e-06, 6.15349188e-07,
                                           3.21655136e-07, 2.09214245e-07, 1.64838796e-07, 1.44634917e-07,
                                           1.32490448e-07, 1.22807178e-07, 1.13770248e-07, 1.04869668e-07,
                                           9.60282991e-08, 8.73042506e-08, 7.87904568e-08, 7.05804456e-08,
                                           6.27563805e-08, 5.53849009e-08, 4.85159742e-08, 4.21831299e-08,
                                           3.64044584e-08, 3.11840962e-08, 2.65140186e-08, 2.23760088e-08,
                                           1.87436902e-08, 1.55845246e-08, 1.28617029e-08, 1.05358643e-08,
                                           8.56660761e-09, 6.91376668e-09, 5.53844365e-09, 4.40380324e-09,
                                           3.47564261e-09, 2.72275900e-09, 2.11714190e-09, 1.63401922e-09,
                                           1.25178717e-09, 9.51852530e-10, 7.18413260e-10, 5.38200576e-10,
                                           4.00201542e-10, 2.95377739e-10, 2.16391793e-10, 1.57350251e-10,
                                           1.13568356e-10, 8.13598398e-11, 5.78529215e-11, 4.08321815e-11,
                                           2.86049748e-11, 1.98903250e-11, 1.37278696e-11, 9.40426830e-12,
                                           6.39450781e-12, 4.31567903e-12, 2.89101752e-12, 1.92225747e-12,
                                           1.26861933e-12, 8.31016639e-13, 5.40314284e-13, 3.48691393e-13,
                                           2.23354024e-13, 1.42005068e-13, 8.96130302e-14, 5.61300575e-14,
                                           3.48960754e-14, 2.15334801e-14, 1.31888885e-14, 8.01785638e-15,
                                           4.83798240e-15, 2.89751699e-15, 1.72243674e-15, 1.01628580e-15,
                                           5.95173464e-16, 3.45960519e-16, 1.99601765e-16, 1.14302718e-16,
                                           6.49687305e-17, 3.66526504e-17, 2.05239203e-17, 1.14070015e-17,
                                           6.29267197e-18, 3.44550553e-18, 1.87240494e-18, 1.01008481e-18,
                                           5.40635356e-19, 2.87440045e-19, 1.51539686e-19, 7.95448529e-20,
                                           4.12554661e-20, 2.13018420e-20, 1.07857428e-20, 5.39287138e-21,
                                           2.96607926e-21, 1.34821785e-21, 8.08930707e-22, 2.69643569e-22,
                                           0.00000000e+00, 2.69643569e-22, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00])},
                     2017: {'Nominal': np.array([6.23014978e-06, 2.61040949e-05, 4.84343070e-05, 9.09646185e-05,
                                              9.76399217e-05, 1.41501548e-04, 1.55313198e-04, 1.64505494e-04,
                                              2.22752297e-04, 5.25363474e-04, 1.05209712e-03, 1.98975913e-03,
                                              3.16576831e-03, 4.53956135e-03, 6.41532447e-03, 9.03417641e-03,
                                              1.26034479e-02, 1.67996603e-02, 2.09727937e-02, 2.48242894e-02,
                                              2.82057842e-02, 3.09401574e-02, 3.30337029e-02, 3.46597516e-02,
                                              3.60553255e-02, 3.73769360e-02, 3.85108300e-02, 3.92232063e-02,
                                              3.93583886e-02, 3.88712880e-02, 3.78229448e-02, 3.63218815e-02,
                                              3.44428224e-02, 3.22419368e-02, 2.98291745e-02, 2.73659863e-02,
                                              2.49951370e-02, 2.28016798e-02, 2.08405021e-02, 1.91795958e-02,
                                              1.79068889e-02, 1.71032719e-02, 1.68088553e-02, 1.69993017e-02,
                                              1.75707490e-02, 1.83352948e-02, 1.90349565e-02, 1.93856149e-02,
                                              1.91462609e-02, 1.81843110e-02, 1.65154417e-02, 1.43092765e-02,
                                              1.18213413e-02, 9.32347147e-03, 7.03966634e-03, 5.10815366e-03,
                                              3.57837930e-03, 2.43185275e-03, 1.61117702e-03, 1.04552303e-03,
                                              6.67389795e-04, 4.20713832e-04, 2.62865030e-04, 1.63352479e-04,
                                              1.01309943e-04, 6.29193392e-05, 3.92581762e-05, 2.46791611e-05,
                                              1.56649007e-05, 1.00520393e-05, 6.52198779e-06, 4.27506925e-06,
                                              2.82651806e-06, 1.88114129e-06, 1.25750008e-06, 8.42573708e-07,
                                              5.64827734e-07, 3.78222568e-07, 2.52658490e-07, 1.68192709e-07,
                                              1.11475265e-07, 7.35054480e-08, 4.81888801e-08, 3.13914348e-08,
                                              2.03090790e-08, 1.30432055e-08, 8.31215866e-09, 5.25433154e-09,
                                              3.29345191e-09, 2.04638631e-09, 1.26012508e-09, 7.68830381e-10,
                                              4.64677743e-10, 2.78164945e-10, 1.64898478e-10, 9.67915953e-11,
                                              5.62491226e-11, 3.23599278e-11, 1.84278589e-11, 1.03868545e-11,
                                              5.79435446e-12, 3.19897618e-12, 1.74774292e-12, 9.44892750e-13,
                                              5.05481728e-13, 2.67563858e-13, 1.40129889e-13, 7.26103838e-14,
                                              3.72233650e-14, 1.88784469e-14, 9.47188383e-15, 4.70123707e-15,
                                              2.30823291e-15, 1.12105197e-15, 5.38573547e-16, 2.55921957e-16,
                                              1.20291197e-16, 5.59185930e-17, 2.57121779e-17, 1.16923974e-17,
                                              5.25946667e-18, 2.33798739e-18, 1.03056353e-18, 4.47102352e-19,
                                              1.92512796e-19, 8.11982106e-20, 3.43887135e-20, 1.43695471e-20,
                                              5.42091856e-21, 1.62193429e-21, 1.50816789e-21, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                              0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]),
                            'Up': np.array([6.03567305e-06, 2.25502419e-05, 3.96659990e-05, 9.14482041e-05,
                                         8.41068127e-05, 1.25383289e-04, 1.50045186e-04, 1.50547893e-04,
                                         1.79460690e-04, 3.40930756e-04, 7.50356650e-04, 1.38549619e-03,
                                         2.40435199e-03, 3.51512804e-03, 4.92248191e-03, 6.83687198e-03,
                                         9.47921873e-03, 1.29433117e-02, 1.68211265e-02, 2.05980049e-02,
                                         2.40757694e-02, 2.71273842e-02, 2.96059836e-02, 3.15242020e-02,
                                         3.30271429e-02, 3.43126009e-02, 3.55314412e-02, 3.66181698e-02,
                                         3.73759691e-02, 3.76536215e-02, 3.73879666e-02, 3.66042655e-02,
                                         3.53891604e-02, 3.38215600e-02, 3.19467748e-02, 2.98284985e-02,
                                         2.75844363e-02, 2.53512846e-02, 2.32309748e-02, 2.12812888e-02,
                                         1.95478815e-02, 1.80925209e-02, 1.69902065e-02, 1.63053774e-02,
                                         1.60667345e-02, 1.62501077e-02, 1.67673102e-02, 1.74627870e-02,
                                         1.81235868e-02, 1.85113799e-02, 1.84141445e-02, 1.77000267e-02,
                                         1.63483298e-02, 1.44694005e-02, 1.22604153e-02, 9.95093888e-03,
                                         7.75102042e-03, 5.81146563e-03, 4.20976524e-03, 2.95852911e-03,
                                         2.02585935e-03, 1.35736460e-03, 8.93452252e-04, 5.79866525e-04,
                                         3.72328860e-04, 2.37262858e-04, 1.50504623e-04, 9.53202421e-05,
                                         6.04534784e-05, 3.85024834e-05, 2.46876122e-05, 1.59676395e-05,
                                         1.04300354e-05, 6.88241963e-06, 4.58523929e-06, 3.08037669e-06,
                                         2.08319044e-06, 1.41552426e-06, 9.64621294e-07, 6.58116739e-07,
                                         4.48855879e-07, 3.05647735e-07, 2.07582189e-07, 1.40486460e-07,
                                         9.46749810e-08, 6.34919907e-08, 4.23493538e-08, 2.80806176e-08,
                                         1.85015474e-08, 1.21081818e-08, 7.86798998e-09, 5.07484132e-09,
                                         3.24809834e-09, 2.06239421e-09, 1.29882436e-09, 8.11105759e-10,
                                         5.02198671e-10, 3.08231392e-10, 1.87508982e-10, 1.13047056e-10,
                                         6.75371772e-11, 3.99791035e-11, 2.34473869e-11, 1.36237251e-11,
                                         7.84168647e-12, 4.47105775e-12, 2.52508322e-12, 1.41248923e-12,
                                         7.82563742e-13, 4.29399920e-13, 2.33343381e-13, 1.25575547e-13,
                                         6.69231161e-14, 3.53179209e-14, 1.84564712e-14, 9.55046201e-15,
                                         4.89339331e-15, 2.48252859e-15, 1.24699221e-15, 6.20174307e-16,
                                         3.05369635e-16, 1.48863799e-16, 7.18492308e-17, 3.43244245e-17,
                                         1.62398759e-17, 7.60289535e-18, 3.52367607e-18, 1.61885126e-18,
                                         7.34575645e-19, 3.29414309e-19, 1.47035284e-19, 6.44280658e-20,
                                         2.84334141e-20, 1.30140549e-20, 4.17573158e-21, 1.39269630e-21,
                                         1.50816789e-21, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                         0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]),
                            'Down': np.array([6.51506677e-06, 2.88789891e-05, 6.31802428e-05, 8.79395994e-05,
                                           1.12525519e-04, 1.57780385e-04, 1.62009084e-04, 1.84262310e-04,
                                           3.21639586e-04, 7.80714452e-04, 1.53585857e-03, 2.76424433e-03,
                                           4.13782359e-03, 5.96783686e-03, 8.54763055e-03, 1.21806835e-02,
                                           1.66938784e-02, 2.13178064e-02, 2.56034266e-02, 2.93685988e-02,
                                           3.23999652e-02, 3.46941110e-02, 3.64597781e-02, 3.79819437e-02,
                                           3.94154035e-02, 4.05837968e-02, 4.12158874e-02, 4.11575441e-02,
                                           4.03948737e-02, 3.90323567e-02, 3.71910790e-02, 3.49421333e-02,
                                           3.23788555e-02, 2.96746518e-02, 2.70199568e-02, 2.45425269e-02,
                                           2.23146538e-02, 2.04115188e-02, 1.89354205e-02, 1.79877414e-02,
                                           1.76240724e-02, 1.78209898e-02, 1.84553452e-02, 1.92981012e-02,
                                           2.00341590e-02, 2.03234203e-02, 1.98940095e-02, 1.86213777e-02,
                                           1.65779462e-02, 1.40091573e-02, 1.12388795e-02, 8.57862301e-03,
                                           6.25387678e-03, 4.37560712e-03, 2.95437250e-03, 1.93592400e-03,
                                           1.23791869e-03, 7.76406837e-04, 4.79833522e-04, 2.93453066e-04,
                                           1.78311540e-04, 1.08075292e-04, 6.55958512e-05, 4.00176005e-05,
                                           2.46188444e-05, 1.53100110e-05, 9.63649373e-06, 6.13883037e-06,
                                           3.95331824e-06, 2.56847725e-06, 1.67947483e-06, 1.10249247e-06,
                                           7.24910310e-07, 4.76470642e-07, 3.12545534e-07, 2.04328417e-07,
                                           1.32984756e-07, 8.60860390e-08, 5.53836063e-08, 3.53876366e-08,
                                           2.24430601e-08, 1.41201458e-08, 8.80874027e-09, 5.44652174e-09,
                                           3.33648878e-09, 2.02431820e-09, 1.21606933e-09, 7.23130352e-10,
                                           4.25555883e-10, 2.47796122e-10, 1.42743997e-10, 8.13362225e-11,
                                           4.58372587e-11, 2.55455059e-11, 1.40776523e-11, 7.67060012e-12,
                                           4.13218172e-12, 2.20065199e-12, 1.15856095e-12, 6.02917539e-13,
                                           3.10131767e-13, 1.57675169e-13, 7.92299999e-14, 3.93465913e-14,
                                           1.93107064e-14, 9.36583061e-15, 4.48886462e-15, 2.12593835e-15,
                                           9.94898359e-16, 4.60044597e-16, 2.10186772e-16, 9.48863115e-17,
                                           4.23161033e-17, 1.86454276e-17, 8.11873233e-18, 3.48976491e-18,
                                           1.48187086e-18, 6.24926559e-19, 2.57975142e-19, 1.05181633e-19,
                                           4.30176971e-20, 1.63726333e-20, 5.92135870e-21, 2.06937200e-21,
                                           1.50816789e-21, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                                           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00])},
                     2018: {'Nominal': np.array([4.54817206e-06, 1.60102060e-05, 5.08879340e-05, 1.14334427e-04,
                                              2.03519945e-04, 3.17198952e-04, 4.68826262e-04, 6.82597352e-04,
                                              9.66474672e-04, 1.34475384e-03, 1.88371727e-03, 2.64841421e-03,
                                              3.69112312e-03, 5.04992453e-03, 6.75607219e-03, 8.84038471e-03,
                                              1.13177165e-02, 1.41622613e-02, 1.72853514e-02, 2.05269968e-02,
                                              2.36733914e-02, 2.65085478e-02, 2.88833712e-02, 3.07634607e-02,
                                              3.22211774e-02, 3.33834893e-02, 3.43773089e-02, 3.52955808e-02,
                                              3.61851286e-02, 3.70513297e-02, 3.78688820e-02, 3.85947629e-02,
                                              3.91780425e-02, 3.95640521e-02, 3.96938719e-02, 3.95047560e-02,
                                              3.89325423e-02, 3.79200271e-02, 3.64283625e-02, 3.44490020e-02,
                                              3.20118382e-02, 2.91867767e-02, 2.60782923e-02, 2.28140643e-02,
                                              1.95301934e-02, 1.63565538e-02, 1.34033472e-02, 1.07519458e-02,
                                              8.45092600e-03, 6.51653207e-03, 4.93761922e-03, 3.68313384e-03,
                                              2.71016314e-03, 1.97126157e-03, 1.42002594e-03, 1.01474978e-03,
                                              7.20193283e-04, 5.07975578e-04, 3.56100537e-04, 2.47997968e-04,
                                              1.71439492e-04, 1.17518140e-04, 7.97901284e-05, 5.36043408e-05,
                                              3.56038233e-05, 2.33662192e-05, 1.51476092e-05, 9.69944590e-06,
                                              6.13591069e-06, 3.83616500e-06, 2.37139655e-06, 1.45016156e-06,
                                              8.77675171e-07, 5.25911354e-07, 3.12064426e-07, 1.83376692e-07,
                                              1.06695955e-07, 6.14494114e-08, 3.50149713e-08, 1.97292550e-08,
                                              1.09853634e-08, 6.04057600e-09, 3.27805823e-09, 1.75450493e-09,
                                              9.25625519e-10, 4.81087410e-10, 2.46212125e-10, 1.24023567e-10,
                                              6.14672259e-11, 2.99629096e-11, 1.43615386e-11, 6.76687035e-12,
                                              3.13367999e-12, 1.42602984e-12, 6.37614458e-13, 2.80106947e-13,
                                              1.20911039e-13, 5.13037939e-14, 2.14199422e-14, 8.82172934e-15,
                                              3.60499771e-15, 1.48143246e-15, 6.29874576e-16, 2.91768593e-16,
                                              1.57208367e-16, 1.02036298e-16, 7.74486274e-17, 6.46187128e-17,
                                              5.64205076e-17, 5.01839138e-17, 4.49314767e-17, 4.02871572e-17,
                                              3.61052912e-17, 3.23166981e-17, 2.88804911e-17, 2.57669080e-17,
                                              2.29506184e-17, 2.04071415e-17, 1.81144701e-17, 1.60518369e-17,
                                              1.41997096e-17, 1.25397760e-17, 1.10549213e-17, 9.72919834e-18,
                                              8.54779211e-18, 7.49697912e-18, 6.56408312e-18, 5.73742767e-18,
                                              5.00628672e-18, 4.36083362e-18, 3.79208950e-18, 3.29187141e-18,
                                              2.85274089e-18, 2.46795326e-18, 2.13140818e-18, 1.83760169e-18,
                                              1.58157994e-18, 1.35889493e-18, 1.16556242e-18, 9.98021912e-19,
                                              8.53099043e-19, 7.27970245e-19, 6.20129733e-19, 5.27358791e-19,
                                              4.47697319e-19, 3.79417555e-19, 3.20999925e-19, 2.71110901e-19,
                                              2.28582790e-19, 1.92395335e-19, 1.61659027e-19, 1.35600022e-19,
                                              1.13546537e-19, 9.49166331e-20, 7.92072640e-20, 6.59844980e-20,
                                              5.48748065e-20, 4.55573263e-20, 3.77570068e-20, 3.12385563e-20,
                                              2.58011095e-20, 2.12735419e-20, 1.75103644e-20, 1.43881344e-20,
                                              1.18023280e-20, 9.66461881e-21, 7.90051861e-21, 6.44733536e-21,
                                              5.25241070e-21, 4.27160237e-21, 3.46798056e-21, 2.81071073e-21,
                                              2.27409856e-21, 1.83677523e-21, 1.48100431e-21, 1.19209310e-21,
                                              9.57894190e-22, 7.68384146e-22, 6.15308213e-22, 4.91881476e-22,
                                              3.92537929e-22, 3.12720369e-22, 2.48704744e-22, 1.97453711e-22,
                                              1.56494777e-22, 1.23819106e-22, 9.77977301e-23, 7.71121960e-23,
                                              6.06974791e-23, 4.76948358e-23, 3.74132342e-23, 2.92976188e-23,
                                              2.29030089e-23, 1.78733472e-23, 1.39242630e-23, 1.08290828e-23,
                                              8.40744729e-24, 6.51612875e-24, 5.04159865e-24, 3.89403678e-24]),
                            'Up': np.array([4.22806627e-06, 1.39810311e-05, 4.34588470e-05, 9.82526442e-05,
                                         1.75570286e-04, 2.74741177e-04, 4.01178945e-04, 5.77654453e-04,
                                         8.14004261e-04, 1.11958086e-03, 1.53879541e-03, 2.13108867e-03,
                                         2.94439551e-03, 4.01744404e-03, 5.37769493e-03, 7.05168511e-03,
                                         9.06293979e-03, 1.14163525e-02, 1.40788322e-02, 1.69639512e-02,
                                         1.99287035e-02, 2.27907170e-02, 2.53709490e-02, 2.75469243e-02,
                                         2.92888480e-02, 3.06538854e-02, 3.17464729e-02, 3.26753270e-02,
                                         3.35248543e-02, 3.43430835e-02, 3.51431026e-02, 3.59107012e-02,
                                         3.66139091e-02, 3.72121879e-02, 3.76611089e-02, 3.79133154e-02,
                                         3.79179975e-02, 3.76217177e-02, 3.69718594e-02, 3.59244469e-02,
                                         3.44531197e-02, 3.25579802e-02, 3.02706611e-02, 2.76544964e-02,
                                         2.47995568e-02, 2.18135292e-02, 1.88102968e-02, 1.58987756e-02,
                                         1.31725218e-02, 1.07024704e-02, 8.53350767e-03, 6.68430282e-03,
                                         5.15048082e-03, 3.91008007e-03, 2.92970489e-03, 2.17043441e-03,
                                         1.59261732e-03, 1.15929631e-03, 8.38184548e-04, 6.02430075e-04,
                                         4.30575064e-04, 3.05998722e-04, 2.16121776e-04, 1.51579842e-04,
                                         1.05472303e-04, 7.27395561e-05, 4.96773252e-05, 3.35733316e-05,
                                         2.24422253e-05, 1.48340344e-05, 9.69521004e-06, 6.26651325e-06,
                                         4.00678894e-06, 2.53537081e-06, 1.58836561e-06, 9.85608823e-07,
                                         6.05973958e-07, 3.69232184e-07, 2.22987739e-07, 1.33466260e-07,
                                         7.91552370e-08, 4.65004221e-08, 2.70463703e-08, 1.55671639e-08,
                                         8.86162396e-09, 4.98619035e-09, 2.77158382e-09, 1.52108555e-09,
                                         8.23805042e-10, 4.40086332e-10, 2.31798848e-10, 1.20332174e-10,
                                         6.15467965e-11, 3.10067392e-11, 1.53823839e-11, 7.51299208e-12,
                                         3.61195867e-12, 1.70901614e-12, 7.95742425e-13, 3.64581325e-13,
                                         1.64370620e-13, 7.29376476e-14, 3.18736230e-14, 1.37365435e-14,
                                         5.85736571e-15, 2.48929934e-15, 1.07112657e-15, 4.81451068e-16,
                                         2.37896597e-16, 1.36618192e-16, 9.29931515e-17, 7.24918355e-17,
                                         6.12730595e-17, 5.38732062e-17, 4.81640049e-17, 4.33256276e-17,
                                         3.90347325e-17, 3.51565495e-17, 3.16289233e-17, 2.84169437e-17,
                                         2.54916853e-17, 2.28331541e-17, 2.04200108e-17, 1.82333188e-17,
                                         1.62553063e-17, 1.44691908e-17, 1.28591705e-17, 1.14104104e-17,
                                         1.01090222e-17, 8.94203941e-18, 7.89738881e-18, 6.96385857e-18,
                                         6.13106349e-18, 5.38940847e-18, 4.73005041e-18, 4.14485922e-18,
                                         3.62637834e-18, 3.16778513e-18, 2.76285160e-18, 2.40590572e-18,
                                         2.09179354e-18, 1.81584243e-18, 1.57382556e-18, 1.36192779e-18,
                                         1.17671309e-18, 1.01509355e-18, 8.74300025e-19, 7.51854525e-19,
                                         6.45544241e-19, 5.53397295e-19, 4.73660146e-19, 4.04776611e-19,
                                         3.45368475e-19, 2.94217604e-19, 2.50249524e-19, 2.12518368e-19,
                                         1.80193141e-19, 1.52545210e-19, 1.28936950e-19, 1.08811469e-19,
                                         9.16833319e-20, 7.71302068e-20, 6.47853733e-20, 5.43310081e-20,
                                         4.54921911e-20, 3.80315660e-20, 3.17445951e-20, 2.64553537e-20,
                                         2.20128117e-20, 1.82875530e-20, 1.51688893e-20, 1.25623254e-20,
                                         1.03873399e-20, 8.57544480e-21, 7.06849501e-21, 5.81721630e-21,
                                         4.77992845e-21, 3.92143916e-21, 3.21208804e-21, 2.62692240e-21,
                                         2.14498801e-21, 1.74872004e-21, 1.42342134e-21, 1.15681631e-21,
                                         9.38670248e-22, 7.60465287e-22, 6.15125042e-22, 4.96781107e-22,
                                         4.00575471e-22, 3.22493705e-22, 2.59224298e-22, 2.08040422e-22,
                                         1.66700649e-22, 1.33365766e-22, 1.06529261e-22, 8.49593122e-23,
                                         6.76504165e-23, 5.37832935e-23, 4.26915324e-23, 3.38340105e-23]),
                            'Down': np.array([4.92041311e-06, 1.85126450e-05, 6.00032009e-05, 1.33781283e-04,
                                           2.37280943e-04, 3.69573218e-04, 5.54265002e-04, 8.14661599e-04,
                                           1.16078537e-03, 1.64370401e-03, 2.34819756e-03, 3.34450284e-03,
                                           4.68722913e-03, 6.41556422e-03, 8.56774887e-03, 1.11705379e-02,
                                           1.42089232e-02, 1.75946668e-02, 2.11498874e-02, 2.46233416e-02,
                                           2.77527292e-02, 3.03549368e-02, 3.23900698e-02, 3.39503692e-02,
                                           3.51909342e-02, 3.62598921e-02, 3.72582660e-02, 3.82290272e-02,
                                           3.91662276e-02, 4.00302729e-02, 4.07646145e-02, 4.13055399e-02,
                                           4.15846297e-02, 4.15280990e-02, 4.10585499e-02, 4.01025882e-02,
                                           3.86050672e-02, 3.65449439e-02, 3.39478959e-02, 3.08903613e-02,
                                           2.74938547e-02, 2.39107925e-02, 2.03051614e-02, 1.68330670e-02,
                                           1.36251269e-02, 1.07748428e-02, 8.33407316e-03, 6.31467666e-03,
                                           4.69601751e-03, 3.43523068e-03, 2.47773790e-03, 1.76618388e-03,
                                           1.24680421e-03, 8.73081305e-04, 6.07085782e-04, 4.19307578e-04,
                                           2.87586799e-04, 1.95703167e-04, 1.31982482e-04, 8.80990252e-05,
                                           5.81355051e-05, 3.78878659e-05, 2.43697049e-05, 1.54645975e-05,
                                           9.68166245e-06, 5.98117447e-06, 3.64785122e-06, 2.19755640e-06,
                                           1.30840663e-06, 7.70307163e-07, 4.48602032e-07, 2.58468978e-07,
                                           1.47327733e-07, 8.30567075e-08, 4.62894197e-08, 2.54884782e-08,
                                           1.38565945e-08, 7.43177932e-09, 3.92936402e-09, 2.04656100e-09,
                                           1.04930074e-09, 5.29265803e-10, 2.62482516e-10, 1.27927056e-10,
                                           6.12449287e-11, 2.87911618e-11, 1.32858185e-11, 6.01640933e-12,
                                           2.67304578e-12, 1.16497574e-12, 4.97987445e-13, 2.08788751e-13,
                                           8.58762518e-14, 3.46750307e-14, 1.37700001e-14, 5.40265139e-15,
                                           2.11746360e-15, 8.50126016e-16, 3.67653968e-16, 1.84421511e-16,
                                           1.13157340e-16, 8.31808878e-17, 6.83609964e-17, 5.92181069e-17,
                                           5.23820979e-17, 4.66546737e-17, 4.16149441e-17, 3.70911419e-17,
                                           3.30114273e-17, 2.93292629e-17, 2.60100083e-17, 2.30237021e-17,
                                           2.03419237e-17, 1.79387035e-17, 1.57896397e-17, 1.38718854e-17,
                                           1.21641239e-17, 1.06465331e-17, 9.30074152e-18, 8.10977667e-18,
                                           7.05800764e-18, 6.13108336e-18, 5.31586741e-18, 4.60037078e-18,
                                           3.97368341e-18, 3.42590546e-18, 2.94807902e-18, 2.53212100e-18,
                                           2.17075758e-18, 1.85746094e-18, 1.58638828e-18, 1.35232378e-18,
                                           1.15062344e-18, 9.77163066e-19, 8.28289413e-19, 7.00774628e-19,
                                           5.91773851e-19, 4.98786012e-19, 4.19617706e-19, 3.52350052e-19,
                                           2.95308415e-19, 2.47034838e-19, 2.06263050e-19, 1.71895882e-19,
                                           1.42984930e-19, 1.18712315e-19, 9.83743657e-20, 8.13670811e-20,
                                           6.71732102e-20, 5.53508126e-20, 4.55231585e-20, 3.73698382e-20,
                                           3.06189610e-20, 2.50403296e-20, 2.04394852e-20, 1.66525268e-20,
                                           1.35416183e-20, 1.09911009e-20, 8.90414007e-21, 7.19984077e-21,
                                           5.81077267e-21, 4.68085217e-21, 3.76353516e-21, 3.02027861e-21,
                                           2.41923454e-21, 1.93414420e-21, 1.54340392e-21, 1.22927822e-21,
                                           9.77238525e-22, 7.75408847e-22, 6.14102218e-22, 4.85434117e-22,
                                           3.83000730e-22, 3.01611969e-22, 2.37070301e-22, 1.85988183e-22,
                                           1.45637462e-22, 1.13825717e-22, 8.87947305e-23, 6.91374733e-23,
                                           5.37303022e-23, 4.16777698e-23, 3.22677818e-23, 2.49352121e-23,
                                           1.92325350e-23, 1.48060483e-23, 1.13768266e-23, 8.72534664e-24,
                                           6.67917861e-24, 5.10320640e-24, 3.89172613e-24, 2.96224137e-24,
                                           2.25049439e-24, 1.70653167e-24, 1.29160951e-24, 9.75717839e-25,
                                           7.35697689e-25, 5.53673893e-25, 4.15895694e-25, 3.11815731e-25])}}


def getPileupReweight(nPUTrue, mcDistribution, dataset, year):
    lookups = {}
    if mcDistribution is None:
        return np.ones_like(nPUTrue), np.ones_like(nPUTrue), np.ones_like(nPUTrue)
    if not (dataset, year) in mcDistribution:
        print ('PU distribution not found')
        return np.ones_like(nPUTrue), np.ones_like(nPUTrue), np.ones_like(nPUTrue)
    mcPUdist = mcDistribution[(dataset,year)]
    mcPUdist = mcPUdist/np.sum(mcPUdist)

    dataDistNom = dataDistributions[year]['Nominal']
    dataDistUp = dataDistributions[year]['Up']
    dataDistDown = dataDistributions[year]['Down']

    #avoid divide by 0 warnings in cases that will not matter
    mcPUdist[mcPUdist==0] = 1.

    puNominal = dense_lookup.dense_lookup(dataDistNom/mcPUdist,np.arange(200))
    puUp = dense_lookup.dense_lookup(dataDistUp/mcPUdist,np.arange(200))
    puDown = dense_lookup.dense_lookup(dataDistDown/mcPUdist,np.arange(200))

    return puNominal(nPUTrue), puUp(nPUTrue), puDown(nPUTrue)

